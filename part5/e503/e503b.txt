Script started on 2022-08-29 00:37:16+03:00 [TERM="xterm-256color" TTY="/dev/pts/2" COLUMNS="199" LINES="44"]
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl apply -k github.com/fluxcd/flagger/kustomize/linkerd
customresourcedefinition.apiextensions.k8s.io/alertproviders.flagger.app created
customresourcedefinition.apiextensions.k8s.io/canaries.flagger.app created
customresourcedefinition.apiextensions.k8s.io/metrictemplates.flagger.app created
serviceaccount/flagger created
clusterrole.rbac.authorization.k8s.io/flagger created
clusterrolebinding.rbac.authorization.k8s.io/flagger created
deployment.apps/flagger created
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n linkerd rollout status deploy/flagger
deployment "flagger" successfully rolled out
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl create ns test && \
>   kubectl apply -f https://run.linkerd.io/flagger.yml
namespace/test created
deployment.apps/load created
configmap/frontend created
deployment.apps/frontend created
service/frontend created
deployment.apps/podinfo created
service/podinfo created
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test rollout status deploy podinfo
deployment "podinfo" successfully rolled out
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test port-forward svc/frontend 8080
Forwarding from 127.0.0.1:8080 -> 8080
Forwarding from [::1]:8080 -> 8080
Handling connection for 8080
Handling connection for 8080
Handling connection for 8080
^C]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl create namespace trafficsplit-sample
namespace/trafficsplit-sample created
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ linkerd inject https://raw.githubusercontent.com/linkerd/linkerd2/main/test/integration/viz/trafficsplit/testdata/application.yaml | kubectl -n trafficsplit-sample apply -f -

document missing "kind" field, skipped
deployment "backend" injected
service "backend-svc" skipped
deployment "failing" injected
service "failing-svc" skipped
deployment "slow-cooker" injected
service "slow-cooker" skipped

deployment.apps/backend created
service/backend-svc created
deployment.apps/failing created
service/failing-svc created
deployment.apps/slow-cooker created
service/slow-cooker created
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl get deployments -n trafficsplit-sample
NAME          READY   UP-TO-DATE   AVAILABLE   AGE
backend       0/1     1            0           13s
failing       0/1     1            0           13s
slow-cooker   1/1     1            1           13s
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ linkerd viz edges deploy -n trafficsplit-sample
SRC           DST           SRC_NS                DST_NS                SECURED       
prometheus    backend       linkerd-viz           trafficsplit-sample   [32;1mâˆš[0m  
prometheus    failing       linkerd-viz           trafficsplit-sample   [32;1mâˆš[0m  
prometheus    slow-cooker   linkerd-viz           trafficsplit-sample   [32;1mâˆš[0m  
slow-cooker   backend       trafficsplit-sample   trafficsplit-sample   [32;1mâˆš[0m  
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl apply -f - <<EOF
> apiVersion: split.smi-spec.io/v1alpha2
> kind: TrafficSplit
> metadata:
>   name: backend-split
>   namespace: trafficsplit-sample
> spec:
>   service: backend-svc
>   backends:
>   - service: backend-svc
>     weight: 500
>   - service: failing-svc
>     weight: 500
> EOF
trafficsplit.split.smi-spec.io/backend-split created
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ linkerd viz edges deploy -n trafficsplit-sample
SRC           DST           SRC_NS                DST_NS                SECURED       
prometheus    backend       linkerd-viz           trafficsplit-sample   [32;1mâˆš[0m  
prometheus    failing       linkerd-viz           trafficsplit-sample   [32;1mâˆš[0m  
prometheus    slow-cooker   linkerd-viz           trafficsplit-sample   [32;1mâˆš[0m  
slow-cooker   backend       trafficsplit-sample   trafficsplit-sample   [32;1mâˆš[0m  
slow-cooker   failing       trafficsplit-sample   trafficsplit-sample   [32;1mâˆš[0m  
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ linkerd viz stat ts/backend-split -n traffic-sample
Error: error creating metrics request while making stats request: cannot find Kubernetes canonical name from friendly name [ts]
Usage:
  linkerd viz stat [flags] (RESOURCES)

Examples:
  # Get all deployments in the test namespace.
  linkerd viz stat deployments -n test

  # Get the hello1 replication controller in the test namespace.
  linkerd viz stat replicationcontrollers hello1 -n test

  # Get all namespaces.
  linkerd viz stat namespaces

  # Get all inbound stats to the web deployment.
  linkerd viz stat deploy/web

  # Get all inbound stats to the pod1 and pod2 pods
  linkerd viz stat po pod1 pod2

  # Get all inbound stats to the pod1 pod and the web deployment
  linkerd viz stat po/pod1 deploy/web

  # Get all pods in all namespaces that call the hello1 deployment in the test namespace.
  linkerd viz stat pods --to deploy/hello1 --to-namespace test --all-namespaces

  # Get all pods in all namespaces that call the hello1 service in the test namespace.
  linkerd viz stat pods --to svc/hello1 --to-namespace test --all-namespaces

  # Get the web service. With Services, metrics are generated from the outbound metrics
  # of clients, and thus will not include unmeshed client request metrics.
  linkerd viz stat svc/web

  # Get the web services and metrics for any traffic coming to the service from the hello1 deployment
  # in the test namespace.
  linkerd viz stat svc/web --from deploy/hello1 --from-namespace test

  # Get the web services and metrics for all the traffic that reaches the web-pod1 pod
  # in the test namespace exclusively.
  linkerd viz stat svc/web --to pod/web-pod1 --to-namespace test

  # Get all services in all namespaces that receive calls from hello1 deployment in the test namespace.
  linkerd viz stat services --from deploy/hello1 --from-namespace test --all-namespaces

  # Get all namespaces that receive traffic from the default namespace.
  linkerd viz stat namespaces --from ns/default

  # Get all inbound stats to the test namespace.
  linkerd viz stat ns/test

  # Get all inbound stats to the emoji-grpc server
  linkerd viz stat server/emoji-grpc

  # Get all inbound stats to the web-public server authorization resource
  linkerd viz stat serverauthorization/web-public

  # Get all inbound stats to the web-get and web-delete HTTP route resources
  linkerd viz stat route/web-get route/web-delete

  # Get all inbound stats to the web-authz authorization policy resource
  linkerd viz stat authorizationpolicy/web-authz
  

Flags:
  -A, --all-namespaces          If present, returns stats across all namespaces, ignoring the "--namespace" flag
      --from string             If present, restricts outbound stats from the specified resource name
      --from-namespace string   Sets the namespace used from lookup the "--from" resource; by default the current "--namespace" is used
  -h, --help                    help for stat
  -n, --namespace string        Namespace of the specified resource
  -o, --output string           Output format; one of: "table" or "json" or "wide" (default "table")
  -l, --selector string         Selector (label query) to filter on, supports '=', '==', and '!='
  -t, --time-window string      Stat window (for example: "15s", "1m", "10m", "1h"). Needs to be at least 15s. (default "1m")
      --to string               If present, restricts outbound stats to the specified resource name
      --to-namespace string     Sets the namespace used to lookup the "--to" resource; by default the current "--namespace" is used
      --unmeshed                If present, include unmeshed resources in the output

Global Flags:
      --api-addr string            Override kubeconfig and communicate directly with the control plane at host:port (mostly for testing)
      --as string                  Username to impersonate for Kubernetes operations
      --as-group stringArray       Group to impersonate for Kubernetes operations
      --cni-namespace string       Namespace in which the Linkerd CNI plugin is installed (default "linkerd-cni")
      --context string             Name of the kubeconfig context to use
      --kubeconfig string          Path to the kubeconfig file to use for CLI requests
  -L, --linkerd-namespace string   Namespace in which Linkerd is installed (default "linkerd")
      --verbose                    Turn on debug logging

]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n linkerd-smi logs deploy/smi-adaptor smi-adaptor
time="2022-08-28T20:51:23Z" level=info msg="Using cluster domain: cluster.local"
time="2022-08-28T20:51:23Z" level=info msg="Starting SMI Controller"
time="2022-08-28T20:51:23Z" level=info msg="Waiting for informer caches to sync"
time="2022-08-28T20:51:23Z" level=info msg="starting admin server on :9995"
time="2022-08-28T20:51:23Z" level=info msg="Starting workers"
time="2022-08-28T20:51:23Z" level=info msg="Started workers"
time="2022-08-28T20:51:23Z" level=info msg="created serviceprofile/podinfo.test.svc.cluster.local for trafficsplit/podinfo"
time="2022-08-28T20:51:23Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:56:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:56:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:56:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:56:28Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:56:28Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:56:28Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:56:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:56:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:56:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:56:48Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:56:48Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:56:48Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:56:58Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:56:58Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:56:58Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:57:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:57:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:57:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:57:18Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:57:18Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:57:18Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:57:28Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:57:28Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:57:28Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:57:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:57:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:57:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:57:48Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:57:48Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:57:48Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T20:58:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T20:58:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T20:58:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:01:23Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:01:23Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:01:23Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:08:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:08:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:08:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:08:18Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:08:18Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:08:18Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:08:28Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:08:28Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:08:28Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:08:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:08:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:08:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:08:48Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:08:48Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:08:48Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:08:58Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:08:58Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:08:58Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:09:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:09:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:09:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:09:18Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:09:18Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:09:18Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:09:28Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:09:28Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:09:28Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:09:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:09:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:09:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:09:58Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:09:58Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:09:58Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:11:23Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:11:23Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:11:23Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:15:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:15:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:15:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:15:58Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:15:58Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:15:58Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:16:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:16:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:16:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:16:18Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:16:18Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:16:18Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:16:28Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:16:28Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:16:28Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:16:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:16:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:16:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:16:48Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:16:48Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:16:48Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:16:58Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:16:58Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:16:58Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:17:08Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:17:08Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:17:08Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:17:18Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:17:18Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:17:18Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:17:38Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:17:38Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:17:38Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:21:23Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:21:23Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:21:23Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:31:23Z" level=info msg="serviceprofile/podinfo.test.svc.cluster.local already present"
time="2022-08-28T21:31:23Z" level=info msg="updated serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:31:23Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:35:07Z" level=info msg="trafficsplit/podinfo is deleted, trying to cleanup the relevant serviceprofile"
time="2022-08-28T21:35:07Z" level=info msg="cleaned up `dstOverrides` of serviceprofile/podinfo.test.svc.cluster.local"
time="2022-08-28T21:35:07Z" level=info msg="Successfully synced 'test/podinfo'"
time="2022-08-28T21:43:33Z" level=info msg="created serviceprofile/backend-svc.trafficsplit-sample.svc.cluster.local for trafficsplit/backend-split"
time="2022-08-28T21:43:33Z" level=info msg="Successfully synced 'trafficsplit-sample/backend-split'"
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl apply -f - <<EOF
> apiVersion: flagger.app/v1beta1
> kind: Canary
> metadata:
>   name: podinfo
>   namespace: test
> spec:
>   targetRef:
>     apiVersion: apps/v1
>     kind: Deployment
>     name: podinfo
>   service:
>     port: 9898
>   analysis:
>     interval: 10s
>     threshold: 5
>     stepWeight: 10
>     maxWeight: 100
>     metrics:
>     - name: request-success-rate
>       thresholdRange:
>         min: 99
>       interval: 1m
>     - name: request-duration
>       thresholdRange:
>         max: 500
>       interval: 1m
> EOF
canary.flagger.app/podinfo created
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test get ev --watch
LAST SEEN   TYPE      REASON                  OBJECT                                  MESSAGE
9m25s       Normal    ScalingReplicaSet       deployment/load                         Scaled up replica set load-7f97579865 to 1
9m25s       Normal    ScalingReplicaSet       deployment/frontend                     Scaled up replica set frontend-6957977dc7 to 1
9m25s       Normal    Injected                deployment/load                         Linkerd sidecar proxy injected
9m25s       Normal    Injected                deployment/frontend                     Linkerd sidecar proxy injected
9m25s       Normal    SuccessfulCreate        replicaset/load-7f97579865              Created pod: load-7f97579865-264df
9m25s       Normal    ScalingReplicaSet       deployment/podinfo                      Scaled up replica set podinfo-7bfd46f477 to 1
9m24s       Normal    Scheduled               pod/load-7f97579865-264df               Successfully assigned test/load-7f97579865-264df to k3d-k3s-default-agent-1
9m24s       Normal    Scheduled               pod/frontend-6957977dc7-qdtp8           Successfully assigned test/frontend-6957977dc7-qdtp8 to k3d-k3s-default-agent-1
9m25s       Normal    Injected                deployment/podinfo                      Linkerd sidecar proxy injected
9m25s       Normal    SuccessfulCreate        replicaset/frontend-6957977dc7          Created pod: frontend-6957977dc7-qdtp8
9m25s       Normal    SuccessfulCreate        replicaset/podinfo-7bfd46f477           Created pod: podinfo-7bfd46f477-sn4gw
9m24s       Normal    Scheduled               pod/podinfo-7bfd46f477-sn4gw            Successfully assigned test/podinfo-7bfd46f477-sn4gw to k3d-k3s-default-agent-0
9m24s       Normal    Pulled                  pod/load-7f97579865-264df               Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
9m24s       Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
9m24s       Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
9m24s       Normal    Created                 pod/load-7f97579865-264df               Created container linkerd-init
9m24s       Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container linkerd-init
9m24s       Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container linkerd-init
9m24s       Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container linkerd-init
9m24s       Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container linkerd-init
9m24s       Normal    Started                 pod/load-7f97579865-264df               Started container linkerd-init
9m24s       Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
9m24s       Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container linkerd-proxy
9m24s       Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container linkerd-proxy
9m24s       Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:35 +0000 UTC: 7bf6f1e87311bb3a81025319102bdb7253ae1583ffdae7f91b17fcf9f70e3c3f
9m24s       Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "quay.io/stefanprodan/podinfo:1.7.0" already present on machine
9m24s       Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container podinfod
9m23s       Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container podinfod
9m23s       Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
9m23s       Normal    Pulled                  pod/load-7f97579865-264df               Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
9m23s       Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container linkerd-proxy
9m23s       Normal    Created                 pod/load-7f97579865-264df               Created container linkerd-proxy
9m23s       Normal    Started                 pod/load-7f97579865-264df               Started container linkerd-proxy
9m23s       Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container linkerd-proxy
9m23s       Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:36 +0000 UTC: d3b4b525f8f0d32711ef8ca79b276a4ddfc5e3812bdc2b934a588da8a64a80f4
9m23s       Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:36 +0000 UTC: 6ae85b0f6302a48b0ed49de9168c44b1b7dead7c0909815fece6244b2ab1e22e
9m23s       Normal    Pulled                  pod/load-7f97579865-264df               Container image "buoyantio/slow_cooker:1.2.0" already present on machine
9m23s       Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "nginx:alpine" already present on machine
9m23s       Normal    Created                 pod/load-7f97579865-264df               Created container slow-cooker
9m23s       Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container nginx
9m23s       Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container nginx
9m23s       Normal    Started                 pod/load-7f97579865-264df               Started container slow-cooker
5s          Normal    Synced                  canary/podinfo                          all the metrics providers are available!
5s          Warning   Synced                  canary/podinfo                          podinfo-primary.test not ready: waiting for rollout to finish: observed deployment generation less than desired generation
5s          Normal    ScalingReplicaSet       deployment/podinfo-primary              Scaled up replica set podinfo-primary-75588f9bf7 to 1
5s          Normal    Injected                deployment/podinfo-primary              Linkerd sidecar proxy injected
5s          Normal    SuccessfulCreate        replicaset/podinfo-primary-75588f9bf7   Created pod: podinfo-primary-75588f9bf7-sm5dn
4s          Normal    Scheduled               pod/podinfo-primary-75588f9bf7-sm5dn    Successfully assigned test/podinfo-primary-75588f9bf7-sm5dn to k3d-k3s-default-agent-1
4s          Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
4s          Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container linkerd-init
4s          Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container linkerd-init
3s          Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
3s          Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container linkerd-proxy
3s          Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container linkerd-proxy
3s          Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:47:56 +0000 UTC: 7f833a9dffb1c7a35895891930a9b4ad58904e71b3f61fe78e850f75396f5a3c
3s          Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "quay.io/stefanprodan/podinfo:1.7.0" already present on machine
3s          Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container podinfod
3s          Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container podinfod
0s          Normal    Synced                  canary/podinfo                          all the metrics providers are available!
0s          Normal    SuccessfulDelete        replicaset/podinfo-7bfd46f477           Deleted pod: podinfo-7bfd46f477-sn4gw
0s          Normal    ScalingReplicaSet       deployment/podinfo                      Scaled down replica set podinfo-7bfd46f477 to 0
0s          Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container linkerd-proxy
0s          Normal    Created                 trafficsplit/podinfo                    Created Service Profile podinfo.test.svc.cluster.local
0s          Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container podinfod
0s          Normal    Synced                  canary/podinfo                          Initialization done! podinfo.test
0s          Warning   Unhealthy               pod/podinfo-7bfd46f477-sn4gw            Liveness probe failed: Get "http://10.42.1.74:4191/live": dial tcp 10.42.1.74:4191: connect: connection refused
0s          Warning   Unhealthy               pod/podinfo-7bfd46f477-sn4gw            Readiness probe failed: Get "http://10.42.1.74:4191/ready": dial tcp 10.42.1.74:4191: connect: connection refused
0s          Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container podinfod
0s          Warning   FailedKillPod           pod/podinfo-7bfd46f477-sn4gw            error killing pod: failed to "KillContainer" for "podinfod" with KillContainerError: "rpc error: code = NotFound desc = an error occurred when try to find container \"6dfa3eb6d3522cda229ef5ce2ec6b431a4a487a80d63647c8fac6c0b7ac63177\": not found"
^C]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test get ev --watch[K[K[K[K[K[K[K[K[K[Kev
LAST SEEN   TYPE      REASON                  OBJECT                                  MESSAGE
10m         Normal    ScalingReplicaSet       deployment/load                         Scaled up replica set load-7f97579865 to 1
10m         Normal    ScalingReplicaSet       deployment/frontend                     Scaled up replica set frontend-6957977dc7 to 1
10m         Normal    Injected                deployment/load                         Linkerd sidecar proxy injected
10m         Normal    Injected                deployment/frontend                     Linkerd sidecar proxy injected
10m         Normal    SuccessfulCreate        replicaset/load-7f97579865              Created pod: load-7f97579865-264df
10m         Normal    ScalingReplicaSet       deployment/podinfo                      Scaled up replica set podinfo-7bfd46f477 to 1
10m         Normal    Scheduled               pod/load-7f97579865-264df               Successfully assigned test/load-7f97579865-264df to k3d-k3s-default-agent-1
10m         Normal    Scheduled               pod/frontend-6957977dc7-qdtp8           Successfully assigned test/frontend-6957977dc7-qdtp8 to k3d-k3s-default-agent-1
10m         Normal    Injected                deployment/podinfo                      Linkerd sidecar proxy injected
10m         Normal    SuccessfulCreate        replicaset/frontend-6957977dc7          Created pod: frontend-6957977dc7-qdtp8
10m         Normal    SuccessfulCreate        replicaset/podinfo-7bfd46f477           Created pod: podinfo-7bfd46f477-sn4gw
10m         Normal    Scheduled               pod/podinfo-7bfd46f477-sn4gw            Successfully assigned test/podinfo-7bfd46f477-sn4gw to k3d-k3s-default-agent-0
10m         Normal    Pulled                  pod/load-7f97579865-264df               Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
10m         Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
10m         Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
10m         Normal    Created                 pod/load-7f97579865-264df               Created container linkerd-init
10m         Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container linkerd-init
10m         Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container linkerd-init
10m         Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container linkerd-init
10m         Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container linkerd-init
10m         Normal    Started                 pod/load-7f97579865-264df               Started container linkerd-init
10m         Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
10m         Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container linkerd-proxy
10m         Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container linkerd-proxy
10m         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:35 +0000 UTC: 7bf6f1e87311bb3a81025319102bdb7253ae1583ffdae7f91b17fcf9f70e3c3f
10m         Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "quay.io/stefanprodan/podinfo:1.7.0" already present on machine
10m         Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container podinfod
10m         Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container podinfod
10m         Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
10m         Normal    Pulled                  pod/load-7f97579865-264df               Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
10m         Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container linkerd-proxy
10m         Normal    Created                 pod/load-7f97579865-264df               Created container linkerd-proxy
10m         Normal    Started                 pod/load-7f97579865-264df               Started container linkerd-proxy
10m         Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container linkerd-proxy
10m         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:36 +0000 UTC: d3b4b525f8f0d32711ef8ca79b276a4ddfc5e3812bdc2b934a588da8a64a80f4
10m         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:36 +0000 UTC: 6ae85b0f6302a48b0ed49de9168c44b1b7dead7c0909815fece6244b2ab1e22e
10m         Normal    Pulled                  pod/load-7f97579865-264df               Container image "buoyantio/slow_cooker:1.2.0" already present on machine
10m         Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "nginx:alpine" already present on machine
10m         Normal    Created                 pod/load-7f97579865-264df               Created container slow-cooker
10m         Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container nginx
10m         Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container nginx
10m         Normal    Started                 pod/load-7f97579865-264df               Started container slow-cooker
86s         Warning   Synced                  canary/podinfo                          podinfo-primary.test not ready: waiting for rollout to finish: observed deployment generation less than desired generation
86s         Normal    ScalingReplicaSet       deployment/podinfo-primary              Scaled up replica set podinfo-primary-75588f9bf7 to 1
86s         Normal    Injected                deployment/podinfo-primary              Linkerd sidecar proxy injected
86s         Normal    SuccessfulCreate        replicaset/podinfo-primary-75588f9bf7   Created pod: podinfo-primary-75588f9bf7-sm5dn
85s         Normal    Scheduled               pod/podinfo-primary-75588f9bf7-sm5dn    Successfully assigned test/podinfo-primary-75588f9bf7-sm5dn to k3d-k3s-default-agent-1
85s         Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
85s         Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container linkerd-init
85s         Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container linkerd-init
84s         Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
84s         Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container linkerd-proxy
84s         Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container linkerd-proxy
84s         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:47:56 +0000 UTC: 7f833a9dffb1c7a35895891930a9b4ad58904e71b3f61fe78e850f75396f5a3c
84s         Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "quay.io/stefanprodan/podinfo:1.7.0" already present on machine
84s         Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container podinfod
84s         Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container podinfod
76s         Normal    Synced                  canary/podinfo                          all the metrics providers are available!
76s         Normal    SuccessfulDelete        replicaset/podinfo-7bfd46f477           Deleted pod: podinfo-7bfd46f477-sn4gw
76s         Normal    ScalingReplicaSet       deployment/podinfo                      Scaled down replica set podinfo-7bfd46f477 to 0
76s         Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container linkerd-proxy
76s         Normal    Created                 trafficsplit/podinfo                    Created Service Profile podinfo.test.svc.cluster.local
76s         Normal    Synced                  canary/podinfo                          Initialization done! podinfo.test
76s         Warning   Unhealthy               pod/podinfo-7bfd46f477-sn4gw            Liveness probe failed: Get "http://10.42.1.74:4191/live": dial tcp 10.42.1.74:4191: connect: connection refused
76s         Warning   Unhealthy               pod/podinfo-7bfd46f477-sn4gw            Readiness probe failed: Get "http://10.42.1.74:4191/ready": dial tcp 10.42.1.74:4191: connect: connection refused
71s         Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container podinfod
71s         Warning   FailedKillPod           pod/podinfo-7bfd46f477-sn4gw            error killing pod: failed to "KillContainer" for "podinfod" with KillContainerError: "rpc error: code = NotFound desc = an error occurred when try to find container \"6dfa3eb6d3522cda229ef5ce2ec6b431a4a487a80d63647c8fac6c0b7ac63177\": not found"
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test set image deployment/podinfo \
>   podinfod=quay.io/stefanprodan/podinfo:1.7.1
deployment.apps/podinfo image updated
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test get ev --watch
LAST SEEN   TYPE      REASON                  OBJECT                                  MESSAGE
12m         Normal    ScalingReplicaSet       deployment/load                         Scaled up replica set load-7f97579865 to 1
12m         Normal    ScalingReplicaSet       deployment/frontend                     Scaled up replica set frontend-6957977dc7 to 1
12m         Normal    Injected                deployment/load                         Linkerd sidecar proxy injected
12m         Normal    Injected                deployment/frontend                     Linkerd sidecar proxy injected
12m         Normal    SuccessfulCreate        replicaset/load-7f97579865              Created pod: load-7f97579865-264df
12m         Normal    ScalingReplicaSet       deployment/podinfo                      Scaled up replica set podinfo-7bfd46f477 to 1
12m         Normal    Scheduled               pod/load-7f97579865-264df               Successfully assigned test/load-7f97579865-264df to k3d-k3s-default-agent-1
12m         Normal    Scheduled               pod/frontend-6957977dc7-qdtp8           Successfully assigned test/frontend-6957977dc7-qdtp8 to k3d-k3s-default-agent-1
12m         Normal    SuccessfulCreate        replicaset/frontend-6957977dc7          Created pod: frontend-6957977dc7-qdtp8
12m         Normal    SuccessfulCreate        replicaset/podinfo-7bfd46f477           Created pod: podinfo-7bfd46f477-sn4gw
12m         Normal    Scheduled               pod/podinfo-7bfd46f477-sn4gw            Successfully assigned test/podinfo-7bfd46f477-sn4gw to k3d-k3s-default-agent-0
12m         Normal    Pulled                  pod/load-7f97579865-264df               Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
12m         Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
12m         Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
12m         Normal    Created                 pod/load-7f97579865-264df               Created container linkerd-init
12m         Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container linkerd-init
12m         Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container linkerd-init
12m         Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container linkerd-init
12m         Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container linkerd-init
12m         Normal    Started                 pod/load-7f97579865-264df               Started container linkerd-init
12m         Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
12m         Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container linkerd-proxy
12m         Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container linkerd-proxy
12m         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:35 +0000 UTC: 7bf6f1e87311bb3a81025319102bdb7253ae1583ffdae7f91b17fcf9f70e3c3f
12m         Normal    Pulled                  pod/podinfo-7bfd46f477-sn4gw            Container image "quay.io/stefanprodan/podinfo:1.7.0" already present on machine
12m         Normal    Created                 pod/podinfo-7bfd46f477-sn4gw            Created container podinfod
12m         Normal    Started                 pod/podinfo-7bfd46f477-sn4gw            Started container podinfod
12m         Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
12m         Normal    Pulled                  pod/load-7f97579865-264df               Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
12m         Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container linkerd-proxy
12m         Normal    Created                 pod/load-7f97579865-264df               Created container linkerd-proxy
12m         Normal    Started                 pod/load-7f97579865-264df               Started container linkerd-proxy
12m         Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container linkerd-proxy
12m         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:36 +0000 UTC: d3b4b525f8f0d32711ef8ca79b276a4ddfc5e3812bdc2b934a588da8a64a80f4
12m         Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:38:36 +0000 UTC: 6ae85b0f6302a48b0ed49de9168c44b1b7dead7c0909815fece6244b2ab1e22e
12m         Normal    Pulled                  pod/load-7f97579865-264df               Container image "buoyantio/slow_cooker:1.2.0" already present on machine
12m         Normal    Pulled                  pod/frontend-6957977dc7-qdtp8           Container image "nginx:alpine" already present on machine
12m         Normal    Created                 pod/load-7f97579865-264df               Created container slow-cooker
12m         Normal    Created                 pod/frontend-6957977dc7-qdtp8           Created container nginx
12m         Normal    Started                 pod/frontend-6957977dc7-qdtp8           Started container nginx
12m         Normal    Started                 pod/load-7f97579865-264df               Started container slow-cooker
2m54s       Warning   Synced                  canary/podinfo                          podinfo-primary.test not ready: waiting for rollout to finish: observed deployment generation less than desired generation
2m54s       Normal    ScalingReplicaSet       deployment/podinfo-primary              Scaled up replica set podinfo-primary-75588f9bf7 to 1
2m54s       Normal    Injected                deployment/podinfo-primary              Linkerd sidecar proxy injected
2m54s       Normal    SuccessfulCreate        replicaset/podinfo-primary-75588f9bf7   Created pod: podinfo-primary-75588f9bf7-sm5dn
2m53s       Normal    Scheduled               pod/podinfo-primary-75588f9bf7-sm5dn    Successfully assigned test/podinfo-primary-75588f9bf7-sm5dn to k3d-k3s-default-agent-1
2m53s       Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
2m53s       Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container linkerd-init
2m53s       Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container linkerd-init
2m52s       Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
2m52s       Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container linkerd-proxy
2m52s       Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container linkerd-proxy
2m52s       Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:47:56 +0000 UTC: 7f833a9dffb1c7a35895891930a9b4ad58904e71b3f61fe78e850f75396f5a3c
2m52s       Normal    Pulled                  pod/podinfo-primary-75588f9bf7-sm5dn    Container image "quay.io/stefanprodan/podinfo:1.7.0" already present on machine
2m52s       Normal    Created                 pod/podinfo-primary-75588f9bf7-sm5dn    Created container podinfod
2m52s       Normal    Started                 pod/podinfo-primary-75588f9bf7-sm5dn    Started container podinfod
2m44s       Normal    Synced                  canary/podinfo                          all the metrics providers are available!
2m44s       Normal    SuccessfulDelete        replicaset/podinfo-7bfd46f477           Deleted pod: podinfo-7bfd46f477-sn4gw
2m44s       Normal    ScalingReplicaSet       deployment/podinfo                      Scaled down replica set podinfo-7bfd46f477 to 0
2m44s       Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container linkerd-proxy
2m44s       Normal    Created                 trafficsplit/podinfo                    Created Service Profile podinfo.test.svc.cluster.local
2m44s       Normal    Synced                  canary/podinfo                          Initialization done! podinfo.test
2m44s       Warning   Unhealthy               pod/podinfo-7bfd46f477-sn4gw            Liveness probe failed: Get "http://10.42.1.74:4191/live": dial tcp 10.42.1.74:4191: connect: connection refused
2m44s       Warning   Unhealthy               pod/podinfo-7bfd46f477-sn4gw            Readiness probe failed: Get "http://10.42.1.74:4191/ready": dial tcp 10.42.1.74:4191: connect: connection refused
2m39s       Normal    Killing                 pod/podinfo-7bfd46f477-sn4gw            Stopping container podinfod
2m39s       Warning   FailedKillPod           pod/podinfo-7bfd46f477-sn4gw            error killing pod: failed to "KillContainer" for "podinfod" with KillContainerError: "rpc error: code = NotFound desc = an error occurred when try to find container \"6dfa3eb6d3522cda229ef5ce2ec6b431a4a487a80d63647c8fac6c0b7ac63177\": not found"
4s          Normal    Synced                  canary/podinfo                          New revision detected! Scaling up podinfo.test
4s          Normal    ScalingReplicaSet       deployment/podinfo                      Scaled up replica set podinfo-69c49997fd to 1
4s          Normal    Injected                deployment/podinfo                      Linkerd sidecar proxy injected
4s          Normal    SuccessfulCreate        replicaset/podinfo-69c49997fd           Created pod: podinfo-69c49997fd-8npgx
3s          Normal    Scheduled               pod/podinfo-69c49997fd-8npgx            Successfully assigned test/podinfo-69c49997fd-8npgx to k3d-k3s-default-agent-0
3s          Normal    Pulled                  pod/podinfo-69c49997fd-8npgx            Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
3s          Normal    Created                 pod/podinfo-69c49997fd-8npgx            Created container linkerd-init
3s          Normal    Started                 pod/podinfo-69c49997fd-8npgx            Started container linkerd-init
2s          Normal    Pulled                  pod/podinfo-69c49997fd-8npgx            Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
2s          Normal    Created                 pod/podinfo-69c49997fd-8npgx            Created container linkerd-proxy
1s          Normal    Started                 pod/podinfo-69c49997fd-8npgx            Started container linkerd-proxy
1s          Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:50:47 +0000 UTC: 63328a57dd299dc2c0d0c689e98c31c175a2aa50ea4c4da50da7bf8b2680ab44
1s          Normal    Pulled                  pod/podinfo-69c49997fd-8npgx            Container image "quay.io/stefanprodan/podinfo:1.7.1" already present on machine
1s          Normal    Created                 pod/podinfo-69c49997fd-8npgx            Created container podinfod
1s          Normal    Started                 pod/podinfo-69c49997fd-8npgx            Started container podinfod
0s          Warning   Synced                  canary/podinfo                          canary deployment podinfo.test not ready: waiting for rollout to finish: 0 of 1 (readyThreshold 100%) updated replicas are available
0s          Normal    Synced                  canary/podinfo                          Starting canary analysis for podinfo.test
0s          Normal    Synced                  canary/podinfo                          Advance podinfo.test canary weight 10
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          Advance podinfo.test canary weight 20
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          Advance podinfo.test canary weight 30
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          Advance podinfo.test canary weight 40
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          Advance podinfo.test canary weight 50
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Advance podinfo.test canary weight 60
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Advance podinfo.test canary weight 70
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Advance podinfo.test canary weight 80
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Advance podinfo.test canary weight 90
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Advance podinfo.test canary weight 100
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Copying podinfo.test template spec to podinfo-primary.test
0s          Normal    ScalingReplicaSet       deployment/podinfo-primary              Scaled up replica set podinfo-primary-f98b7b897 to 1
0s          Normal    Injected                deployment/podinfo-primary              Linkerd sidecar proxy injected
0s          Normal    SuccessfulCreate        replicaset/podinfo-primary-f98b7b897    Created pod: podinfo-primary-f98b7b897-dsfxb
0s          Normal    Scheduled               pod/podinfo-primary-f98b7b897-dsfxb     Successfully assigned test/podinfo-primary-f98b7b897-dsfxb to k3d-k3s-default-server-0
0s          Normal    Pulled                  pod/podinfo-primary-f98b7b897-dsfxb     Container image "cr.l5d.io/linkerd/proxy-init:v2.0.0" already present on machine
0s          Normal    Created                 pod/podinfo-primary-f98b7b897-dsfxb     Created container linkerd-init
0s          Normal    Started                 pod/podinfo-primary-f98b7b897-dsfxb     Started container linkerd-init
0s          Normal    Pulled                  pod/podinfo-primary-f98b7b897-dsfxb     Container image "cr.l5d.io/linkerd/proxy:stable-2.12.0" already present on machine
0s          Normal    Created                 pod/podinfo-primary-f98b7b897-dsfxb     Created container linkerd-proxy
0s          Normal    Started                 pod/podinfo-primary-f98b7b897-dsfxb     Started container linkerd-proxy
0s          Normal    IssuedLeafCertificate   serviceaccount/default                  issued certificate for default.test.serviceaccount.identity.linkerd.cluster.local until 2022-08-29 21:52:45 +0000 UTC: fddda1bb8a8d64d0d6e6570ed2bdacd98aebceb515bf81707871e6350ee58943
0s          Normal    Pulled                  pod/podinfo-primary-f98b7b897-dsfxb     Container image "quay.io/stefanprodan/podinfo:1.7.1" already present on machine
0s          Normal    Created                 pod/podinfo-primary-f98b7b897-dsfxb     Created container podinfod
0s          Normal    Started                 pod/podinfo-primary-f98b7b897-dsfxb     Started container podinfod
0s          Normal    ScalingReplicaSet       deployment/podinfo-primary              Scaled down replica set podinfo-primary-75588f9bf7 to 0
0s          Normal    SuccessfulDelete        replicaset/podinfo-primary-75588f9bf7   Deleted pod: podinfo-primary-75588f9bf7-sm5dn
0s          Normal    Killing                 pod/podinfo-primary-75588f9bf7-sm5dn    Stopping container linkerd-proxy
0s          Normal    Killing                 pod/podinfo-primary-75588f9bf7-sm5dn    Stopping container podinfod
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Routing all traffic to primary
0s          Normal    Updated                 trafficsplit/podinfo                    Updated Service Profile podinfo.test.svc.cluster.local
0s          Normal    Synced                  canary/podinfo                          (combined from similar events): Promotion completed! Scaling down podinfo.test
0s          Normal    ScalingReplicaSet       deployment/podinfo                      Scaled down replica set podinfo-69c49997fd to 0
0s          Normal    SuccessfulDelete        replicaset/podinfo-69c49997fd           Deleted pod: podinfo-69c49997fd-8npgx
0s          Normal    Killing                 pod/podinfo-69c49997fd-8npgx            Stopping container linkerd-proxy
0s          Normal    Killing                 pod/podinfo-69c49997fd-8npgx            Stopping container podinfod
0s          Warning   Unhealthy               pod/podinfo-69c49997fd-8npgx            Liveness probe failed: Get "http://10.42.1.76:4191/live": dial tcp 10.42.1.76:4191: connect: connection refused
0s          Warning   Unhealthy               pod/podinfo-69c49997fd-8npgx            Readiness probe failed: Get "http://10.42.1.76:4191/ready": dial tcp 10.42.1.76:4191: connect: connection refused
0s          Normal    Killing                 pod/podinfo-69c49997fd-8npgx            Stopping container podinfod
0s          Warning   FailedKillPod           pod/podinfo-69c49997fd-8npgx            error killing pod: failed to "KillContainer" for "podinfod" with KillContainerError: "rpc error: code = NotFound desc = an error occurred when try to find container \"f0c7e55a5b0dff0eb5565df6e52faaba805f11a88725fc38442d03a09eb9cb6b\": not found"

^C]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ watch kubectl -n test get canary
[?1049h[22;0;0t[1;44r(B[m[4l[?7h[H[2JEvery 2,0s: kubectl -n test get canary[1;165HEB8560w20: Mon Aug 29 00:55:41 2022[3;1HNAME[11GSTATUS[23GWEIGHT   LASTTRANSITIONTIME[4dpodinfo   Succeeded   0[4;32H2022-08-28T21:52:44Z[44;199H[1;194H3[44;199H[1;194H6[44;199H[1;194H8[44;199H[1;193H50[44;199H[1;194H2[44;199H[44;1H[?1049l[23;0;0t[?1l>]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ kubectl -n test get trafficsplit podinfo -o yaml
apiVersion: split.smi-spec.io/v1alpha2
kind: TrafficSplit
metadata:
  creationTimestamp: "2022-08-28T21:47:44Z"
  generation: 12
  name: podinfo
  namespace: test
  ownerReferences:
  - apiVersion: flagger.app/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: Canary
    name: podinfo
    uid: e03f86b6-5940-4e6f-9e30-1e7be0a9cf5f
  resourceVersion: "672221"
  uid: 22753f27-3718-4391-a3bc-6ed34f67af51
spec:
  backends:
  - service: podinfo-canary
    weight: "0"
  - service: podinfo-primary
    weight: "100"
  service: podinfo
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ 
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ watch linkerd viz -n test stat deploy --from deploy/load
[?1049h[22;0;0t[1;44r(B[m[4l[?7h[H[2JEvery 2,0s: linkerd viz -n test stat deploy --from deploy/load[1;165HEB8560w20: Mon Aug 29 00:56:46 2022[3;1HNAME[3;19HMESHED   SUCCESS[42GRPS   LATENCY_P50   LATENCY_P95   LATENCY_P99   TCP_CONN[4dpodinfo[4;22H0/0[4;34H-[4;44H-[4;58H-[4;72H-[4;86H-[4;97H-[5dpodinfo-primary[22G1/1   100.00%   10.0rps[5;56H1ms[5;70H2ms[5;84H3ms[5;97H1[44;199H[1;194H8[44;199H[1;193H51[44;199H[1;194H4[5;84H2[44;199H[1;194H7[44;199H[1;191H7:00[44;199H[1;194H2[44;199H[1;194H5[44;199H[1;194H8[44;199H[1;193H11[44;199H[1;194H3[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H22[44;199H[1;194H4[44;199H[1;194H7[44;199H[1;193H30[44;199H[1;194H3[44;199H[1;194H5[44;199H[1;194H8[44;199H[1;193H41[44;199H[1;194H4[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H52[44;199H[1;194H5[44;199H[1;194H7[44;199H[1;191H8:00[44;199H[1;194H3[5;84H3[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H11[44;199H[1;194H4[5;83H20[44;199H[1;194H7[44;199H[1;193H20[44;199H[1;194H3[44;199H[1;194H5[5;83H 5[44;199H[1;194H8[44;199H[1;193H31[44;199H[1;194H4[5;84H3[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H42[44;199H[1;194H5[5;83H10[44;199H[1;194H7[44;199H[1;193H50[44;199H[1;194H3[5;70H4[44;199H[1;194H6[44;199H[1;194H8[44;199H[1;191H9:01[44;199H[1;194H4[44;199H[1;194H7[44;199H[1;193H10[44;199H[1;194H2[44;199H[1;194H5[5;70H2[44;199H[1;194H8[44;199H[1;193H21[44;199H[1;194H3[5;83H 5[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H32[44;199H[1;194H4[5;84H4[44;199H[1;194H7[44;199H[1;193H40[44;199H[1;194H3[44;199H[1;194H5[44;199H[1;194H8[44;199H[1;193H51[44;199H[1;194H4[5;84H3[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;188H1:00:02[44;199H[1;194H5[5;84H8[44;199H[1;194H7[44;199H[1;193H10[44;199H[1;194H3[5;70H3[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H21[44;199H[1;194H4[5;70H2[5;84H4[44;199H[1;194H7[44;199H[1;194H9[44;199H[1;193H32[44;199H[1;194H5[5;83H10[44;199H[1;194H8[44;199H[1;193H41[44;199H[1;194H3[5;83H 2[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H51[44;199H[1;194H4[5;83H10[44;199H[1;194H7[44;199H[1;191H1:00[44;199H[1;194H3[44;199H[1;194H5[5;70H3[5;84H7[44;199H[1;194H8[44;199H[1;193H11[44;199H[1;194H4[5;83H 8[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H22[44;199H[1;194H5[5;70H2[5;84H5[44;199H[1;194H7[44;199H[1;193H30[44;199H[1;194H3[5;83H10[44;199H[1;194H6[44;199H[1;194H8[44;199H[1;193H41[44;199H[1;194H4[5;83H 5[44;199H[1;194H7[44;199H[1;193H50[44;199H[1;194H2[44;199H[1;194H5[5;84H8[44;199H[1;194H8[44;199H[1;191H2:01[44;199H[1;194H3[5;70H4[5;83H25[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H12[44;199H[1;194H5[5;70H3[5;83H10[44;199H[1;194H7[44;199H[1;193H20[44;199H[1;194H3[44;199H[1;194H6[5;70H2[5;83H 8[44;199H[1;194H8[44;199H[1;193H31[44;199H[1;194H4[5;70H3[5;83H15[44;199H[1;194H7[44;199H[1;194H9[44;199H[1;193H42[44;199H[1;194H5[5;70H2[5;83H 3[44;199H[1;194H8[44;199H[1;193H51[44;199H[1;194H3[5;70H3[5;84H5[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;191H3:02[44;199H[1;194H4[5;83H10[44;199H[1;194H7[44;199H[1;193H10[44;199H[1;194H3[44;199H[1;194H5[5;70H2[5;83H 3[44;199H[1;194H8[44;199H[1;193H21[44;199H[1;194H4[5;84H5[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H32[44;199H[5d[J[1;194H5[4;8H-primary[22G1/1   100.00%   10.0rps[4;56H1ms[4;70H3ms[4;84H8ms[4;97H1[44;199H[1;194H7[44;199H[1;193H40[44;199H[1;194H3[4;70H2[44;199H[1;194H6[4;84H3[44;199H[1;194H8[44;199H[1;193H51[44;199H[1;194H4[44;199H[1;194H7[44;199H[1;194H9[44;199H[1;191H4:02[44;199H[1;194H5[44;199H[1;194H8[44;199H[1;193H10[44;199H[1;194H3[4;70H3[4;83H10[44;199H[1;194H6[44;199H[1;194H9[44;199H[1;193H21[44;199H[1;194H4[4;70H2[4;83H 4[44;199H[1;194H7[44;199H[1;193H30[44;199H[1;194H2[44;199H[44;1H[?1049l[23;0;0t[?1l>]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ 
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ watch linkerd viz -n test stat deploy --from deploy/load[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kkubectl delete -k github.com/fluxcd/flagger/kustomize/linkerd && \
>   kubectl delete ns test
customresourcedefinition.apiextensions.k8s.io "alertproviders.flagger.app" deleted
customresourcedefinition.apiextensions.k8s.io "canaries.flagger.app" deleted
customresourcedefinition.apiextensions.k8s.io "metrictemplates.flagger.app" deleted
serviceaccount "flagger" deleted
clusterrole.rbac.authorization.k8s.io "flagger" deleted
clusterrolebinding.rbac.authorization.k8s.io "flagger" deleted
deployment.apps "flagger" deleted
namespace "test" deleted
]0;rvl@EB8560w20: ~/kod/kuber/parts/part5/e503[01;32mrvl@EB8560w20[00m:[01;34m~/kod/kuber/parts/part5/e503[00m$ exit

Script done on 2022-08-29 01:07:12+03:00 [COMMAND_EXIT_CODE="0"]
